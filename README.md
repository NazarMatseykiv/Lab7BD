Airline Delay and Cancellation Analysis (2018)
1. Опис датасету
Назва датасету: Airline Delay and Cancellation Data 2009-2018
Джерело: Kaggle
Файл аналізу: 2018.csv
Кількість записів: > 1,000,000
Кількість колонок: 29 (у тому числі FL_DATE, OP_CARRIER, ORIGIN, DEST, DEP_DELAY, ARR_DELAY, CANCELLED)
Типи даних: числові (затримки, відстань), категоріальні (авіакомпанії, аеропорти), дати та час (FL_DATE, DEP_TIME, ARR_TIME)

2. Виконані завдання та отримані результати
Рівень 1: Базова обробка
Створено SparkSession AirlineAnalysis з налаштуваннями:
spark.sql.adaptive.enabled=true
spark.serializer=org.apache.spark.serializer.KryoSerializer
Завантажено CSV з 2018 року, перевірено схему та перші 20 рядків.
Відфільтровано рейси з аеропорту JFK та затримкою >15 хвилин.
Збережено відфільтровані дані у Parquet з partitioning по OP_CARRIER.

Рівень 2: Складні агрегації
По кожному аеропорту обчислено:
Загальну кількість рейсів (total_flights)
Середню затримку вильоту (avg_dep_delay)
Максимальну затримку прибуття (max_arr_delay)
Відсоток скасованих рейсів (cancellation_rate)
Відсортовано топ-20 найбільш завантажених аеропортів.

3. Ключові знахідки
Найбільш завантажені аеропорти: JFK, LAX, ORD, ATL, SFO.
Середня затримка вильоту по найбільш завантажених аеропортах коливається від ~12 до 25 хвилин.
Відсоток скасованих рейсів рідко перевищує 3%, найчастіше через погані погодні умови.
Найбільша кількість рейсів припадає на будні дні (понеділок–п’ятниця), пік у липні та серпні.

4. Час виконання
Завантаження датасету та попередня обробка: ~ 1 година 48 хвилин
Фільтрація та агрегації: ~1-2 хвилин
Часовий аналіз та heat map: ~1 хвилина
Час виміряно на машині з 8 ядрами CPU, 16GB RAM.

5. Проблеми та рішення
Великий розмір датасету: застосовано Spark і partitioning при збереженні.
Пропущені значення в DEP_DELAY та ARR_DELAY: ігнорували під час обчислення середніх.
Часові дані DEP_TIME/ARR_TIME у форматі HHMM: конвертовано у години для аналізу.

6. Висновки та рекомендації
Рейси найбільш завантажених аеропортів варто планувати з урахуванням пікових годин та місяців.
Авіакомпаніям рекомендовано аналізувати причини скасувань та затримок, щоб оптимізувати графік.
Heat map допомагає швидко виявляти проблемні дні та місяці для ресурсного планування.
Подальші дослідження: аналіз залежності затримок від погодних умов та тривалості рейсу, побудова прогнозних моделей затримок.# Lab7BD
